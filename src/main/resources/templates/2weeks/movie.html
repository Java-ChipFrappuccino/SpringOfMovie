<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="inc/layout">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/desktop.css">
    <title>2ì£¼ì˜ ì˜í™” - ì˜í™”ì˜ë´„</title>
<!--    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.11.0/dist/sweetalert2.all.min.js"></script>-->
<!--    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.11.0/dist/sweetalert2.min.css" rel="stylesheet">-->
<!--    <link rel="stylesheet" type="text/css" href="/css/components/movie/detail.css">-->
    <link rel="stylesheet" href="/css/components/movie/list.css">
    <script src="/js/movie/list.js" defer></script>
    <script src="/js/movie/detail.js" defer></script>
    <style>
        .delete-button {
            position: relative;
            bottom: 52px;
            right: -760px;
        }
        .empty-field {
            /*position: relative;*/
            /*bottom: -10px;*/
            /*right: 1086px;*/
            /*margin-left: 6px;*/
            /*margin-top: 8px;*/
            opacity: 0;
            transition: opacity 0.5s;
        }
        .show-and-hide {
            opacity: 1;
        }

        .charCount {
            /*position: relative;*/
            /*bottom: -10px;*/
            /*right: 1090px;*/
        }
    </style>
</head>

<body>
    <main layout:fragment="main" class="media">
        <section class="media-sect-for-2weeks media-mobile">
            <h1 class="d:none">ë©”ì¸</h1>
            <section class="my:6  px:2">
                <button id="playButton" class="n-btn n-btn:outline ">ìŒì•… ì¬ìƒ</button>
                <audio id="myAudio">
                    <source src="/media/movieSong2.mp3" type="audio/mpeg">
                    Your browser does not support the audio element.
                </audio>
                <script>
                    window.onload = function () {
                        var audio = document.getElementById("myAudio");

                        var playButton = document.getElementById("playButton");
                        playButton.addEventListener("click", function () {
                            audio.play();
                        });
                    };

                </script>
                <section  th:if="${movie.voteCount != 0}" class="">
                    <div class="txt-al:center">
                        <h1 class="fw:3 fs:8">ğŸ–ï¸2ì£¼ì˜ ì˜í™”</h1>
                    </div>
                    <div class="m-top:4">
                        <div class="d:flex jc:center h:8">
                            <img class="bd-radius:1 box-shadow:1" src=""
                                th:src="${movie.posterUrl != null ? movie.posterUrl : '/image/no_image_poster.png'}"
                                alt="dd">
                        </div>
                        <div class="m-top:4">
                            <div class="d:flex jc:center ai:center gap:2">
                                <span th:text="${movie.korName}" class="fs:6">ì˜í™”ì œëª©</span>
                            </div>
                        </div>
                        <div class="m-top:4">
                            <div class="d:flex jc:center">
                                <span th:text="${movie.movieIntro}">ì¤„ê±°ë¦¬</span>
                            </div>
                        </div>
                    </div>
                </section>

                <section th:if="${movie.voteCount == 0}" class="">
                    <div class="txt-al:center">
                        <h1 class="fw:3 fs:8">ğŸ–ï¸2ì£¼ì˜ì˜í™”</h1>
                    </div>
                    <div class="m-top:4">
                        <div class="d:flex jc:center h:8">
                            <img class="bd-radius:1 box-shadow:1"
                                src="/image/no_image_poster.png"
                                alt="dd">
                        </div>
                        <div class="m-top:4">
                            <div class="d:flex jc:center ai:center gap:2">
                                <span class="fs:6">íˆ¬í‘œë¥¼ ë°›ì€ ì˜í™”ê°€ ì—†ìŠµë‹ˆë‹¤</span>
                            </div>
                        </div>
                        <div class="m-top:4">
                            <div class="d:flex jc:center">
                                ì²«ë²ˆì§¸ë¡œ 2ì£¼ì˜ì˜í™”ì— íˆ¬í‘œë¥¼ í•´ë³´ì„¸ìš”!
                            </div>
                        </div>
                        <div class="d:flex jc:center my:4">
                            <a href="/2weeks/list">
                                <button class="n-btn n-btn-color:main">í›„ë³´ ë³´ëŸ¬ê°€ê¸°</button>
                            </a>
                        </div>
                    </div>
                </section>

                <section th:if="${movie.voteCount != 0}">
                    <h1 class="d:none">í•œì¤„ í‰</h1>
                    <div class="d:flex mb:5 bd-top py:4">
                        <h1 class="pl:1 fw:3 fs:5 section-font border-left bd-color:main-2 bd-w:3  mr:auto">í•œì¤„ í‰
                            <span class="fs:3 fw:2 color:base-10"
                                th:with="formattedSize=${reviews.size() > 999 ? #numbers.formatInteger(reviews.size(),3,'COMMA') : reviews.size()}"
                                th:text="${'('+formattedSize+' ê°œ)'}">(3,426ë¦¬ë·°)
                            </span>
                        </h1>
                    </div>
                    <ul class="d:flex flex-direction:column gap:2">
                        <li th:each="r ,count: ${reviews}" class="n-item n-item-type:shadow ttr">
                            <div class="d:flex flex-direction:column gap:2">
                                <div class="d:flex">
                                    <span th:text="${r.memberRate}+ì›"
                                        class="margin-right:auto color:sub-1 fw:bold">í‰ì </span>
                                    <span th:text="${#dates.format(r.regDate, 'yyyyë…„ MMì›” ddì¼')}">ë‚ ì§œ</span>
                                </div>
                                <div class="d:flex ai:center gap:3">
                                    <span class="icon icon:user">ì•„ì´ì½˜</span>
                                    <span th:text="${r.nickname}">ë‹‰ë„¤ì„</span>
                                </div>
                                <div th:text="${r.comments}">í•œì¤„í‰ì´ ì¶œë ¥ë©ë‹ˆë‹¤</div>
                                <div class="d:inline-block ">
                                    <span class="icon icon:thumbs_up">ì•„ì´ì½˜</span>
                                    <span th:text="${count.count}">ì¢‹ì•„ìš” ìˆ˜</span>
                                    <button class="ml:2">ì¢‹ì•„ìš”</button>
                                </div>
                            </div>
                        </li>
                    </ul>
                <div id="content" class="toggle-off">
                    <div
                    th:if="${reviews == null or #lists.isEmpty(reviews)}" 
                    class="txt-al:center fs:5 fw:3 mb:3">
                        <span>1ë“±ìœ¼ë¡œ ë¦¬ë·°ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”!</span>
                    </div>
                    <form th:action="${myReview != null ? 'comment/edit/'+movie.movieCd : 'comment'}" action="comment"
                        method="POST" class="reg-form">
                        <div class="display:flex justify-content:space-between fs:4">
                            <input type="text" name="movieCd" th:value="${movie.movieCd}" class="d:none">
                            <select class="n-select" id="rate" name="rate" type="">
                                <option disabled selected value="15000">ì ì •ê°€ê²©ì„ ê³¨ë¼ì£¼ì„¸ìš”</option>
                                <option th:selected="${myReview != null and myReview.memberRate == 0}" value="0">0ì›
                                </option>
                                <option th:selected="${myReview != null and myReview.memberRate == 5000}" value="5000">
                                    5,000ì›</option>
                                <option th:selected="${myReview != null and myReview.memberRate == 10000}"
                                    value="10000">10,000ì›</option>
                                <option th:selected="${myReview != null and myReview.memberRate == 15000}"
                                    value="15000">15,000ì›</option>
                                <option th:selected="${myReview != null and myReview.memberRate == 20000}"
                                    value="20000">20,000ì›</option>
                                <option th:selected="${myReview != null and myReview.memberRate == 25000}"
                                    value="25000">25,000ì›</option>
                                <option th:selected="${myReview != null and myReview.memberRate == 30000}"
                                    value="30000">30,000ì›</option>
                            </select>
                        </div>
                        <div class="display:flex align-items:flex-end flex-direction:column">
                            <!--ë¹„íšŒì› ì ‘ì†ì‹œ-->
                            <textarea sec:authorize="isAnonymous()" disabled
                                class="anonymous-font-size width:10p height:2 p:2 n-textbox n-textbox-status:success"
                                type="text" placeholder="ë¡œê·¸ì¸í›„ ì´ìš©í•˜ì‹¤ìˆ˜ ìˆìŠµë‹ˆë‹¤."></textarea>

                            <a href="/user/signin">
                                <button sec:authorize="isAnonymous()" type="button"
                                class="n-btn n-btn-type:filled m:2 submit-buttons">ë¡œê·¸ì¸í•˜ê¸°</button>
                            </a>
                            <!--íšŒì› ì ‘ì†ì‹œ-->
                            <textarea sec:authorize="isAuthenticated()"
                                th:text="${myReview != null ? myReview.comments : ''}" id="comments" name="comments"
                                class="width:10p height:2 p:2 n-textbox reg-textarea n-textbox-status:success" type="text"
                                placeholder="ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”." maxlength="50"></textarea>
                            <div class="mr:auto mt:1">
                                <span sec:authorize="isAuthenticated()" class="charCount ml:2 color:base-6">0 / 50</span>
                                <span sec:authorize="isAuthenticated()" class="color:accent-1 empty-field">ê³µë°±ì€ ì…ë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</span></div>
                            <div class="d:flex">
                                <!--í‰ê°€ or ìˆ˜ì •ë²„íŠ¼-->
                                <button sec:authorize="isAuthenticated()" type="submit"
                                    th:text="${myReview != null ? 'ìˆ˜ì •ì™„ë£Œ' : 'í‰ê°€ì™„ë£Œ'}"
                                    class="n-btn n-btn-type:filled m:2 submit-button">í‰ê°€í•˜ê¸°
                                </button>
                            </div>
                        </div>
                    </form>
                    <form th:action="${myReview != null ? 'comment/delete/'+movie.movieCd : 'comment'}" action="comment" method="POST">
                        <!--ì‚­ì œìš”ì²­ ë²„íŠ¼-->
                       <input type="text" name="movieCd" th:value="${movie.movieCd}" class="d:none">
                       <button sec:authorize="isAuthenticated()" type="submit"
                       th:if="${myReview != null}"
                       class="n-btn n-btn-type:filled m:2 delete-button n-btn-color:accent">ì‚­ì œí•˜ê¸°
                   </button>
                   </form>
                    <div class="d:flex jc:center my:4">
                        <a href="/2weeks/list">
                            <button class="n-btn n-btn-color:main">ë‹¤ìŒì£¼ í›„ë³´ ë³´ëŸ¬ê°€ê¸°</button>
                        </a>
                    </div>
                </div>
            </section>
            </section>
        </section>
        </section>
    </main>
</body>

</html>